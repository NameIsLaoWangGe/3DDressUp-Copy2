{
  "code": "import { Admin, Animation2D, Effects2D, StorageAdmin, TimerAdmin, Tools } from \"./Lwg\";\r\nimport { _GameEvent } from \"./_GameEvent\";\r\nexport var _Guide;\r\n(function (_Guide) {\r\n    _Guide._complete = {\r\n        get value() {\r\n            return StorageAdmin._bool('_Guide_complete').value;\r\n        },\r\n        set value(val) {\r\n            StorageAdmin._bool('_Guide_complete').value = val;\r\n        }\r\n    };\r\n    _Guide._whichStep = {\r\n        get num() {\r\n            return Laya.LocalStorage.getItem('_Guide_whichStep') ? Number(Laya.LocalStorage.getItem('_Guide_whichStep')) : 1;\r\n        },\r\n        set num(num0) {\r\n            Laya.LocalStorage.setItem('_Guide_whichStep', num0.toString());\r\n        }\r\n    };\r\n    _Guide.MmakeTailorBtnComSwicth = false;\r\n    _Guide.MakePatternFrame1Swicth = true;\r\n    _Guide.MakePatternBtnTurnFaceSwicth = false;\r\n    _Guide.MakePatternFrame2Swicth = true;\r\n    _Guide.MakePatternBtnComSwicth = false;\r\n    class Guide extends Admin._SceneBase {\r\n        constructor() {\r\n            super(...arguments);\r\n            this.btnComX = Laya.stage.width - 250;\r\n            this.btnComY = 70;\r\n            this.bgType = {\r\n                present: 'present',\r\n                vanish: 'vanish',\r\n                appear: 'appear',\r\n            };\r\n            this._stepTailor = 0;\r\n            this.posArr = [\r\n                [Laya.stage.width / 2 + 110, 140],\r\n                [Laya.stage.width / 2 - 110, Laya.stage.height / 2 - 220],\r\n                [Laya.stage.width / 2 + 100, Laya.stage.height / 2 - 200],\r\n                [Laya.stage.width / 2 + 200, Laya.stage.height - 150],\r\n            ];\r\n            this.nameArr = ['Line01', 'Line02', 'Line03', 'Line04'];\r\n            this.presentName = null;\r\n        }\r\n        lwgOpenAni() {\r\n            return 200;\r\n        }\r\n        lwgOnAwake() {\r\n            this._ImgVar('Hand').scale(0, 0);\r\n            this.handDiffX = this.handDiffX;\r\n            this.handDiffY = this.handDiffY;\r\n        }\r\n        clickEffcet() {\r\n            Effects2D._Aperture._continuous(this._Owner, [this._ImgVar('Hand').x, this._ImgVar('Hand').y + 30], [6, 6], null, null, [Effects2D._SkinUrl.圆形小光环], null, this._ImgVar('Hand').zOrder - 1, [1.2, 1.2], [0.6, 0.6], [0.01, 0.01]);\r\n        }\r\n        boreholeCircle(arr, handX, handY, func) {\r\n            for (let index = 0; index < arr.length; index++) {\r\n                const time = 80 / 8;\r\n                let radiusBase = 15;\r\n                const element = arr[index];\r\n                const speed = (arr[index][2] - radiusBase) / time;\r\n                TimerAdmin._frameNumLoop(1, time, this, () => {\r\n                    radiusBase += speed;\r\n                    element[2] = radiusBase;\r\n                    Tools._Draw.reverseCircleMask(this._ImgVar('Background'), arr, true);\r\n                }, () => {\r\n                    func && func();\r\n                }, true);\r\n            }\r\n            handX && this._ImgVar('Hand').pos(handX, handY - 30);\r\n        }\r\n        boreholeRoundrect(arr, handX, handY, func) {\r\n            Tools._Draw.reverseRoundrectMask(this._ImgVar('Background'), arr);\r\n            handX && this._ImgVar('Hand').pos(handX, handY);\r\n            this._AniVar('Click').play(0, true);\r\n            for (let index = 0; index < arr.length; index++) {\r\n                let widthBase = 10;\r\n                let heightBase = 10;\r\n                const element = arr[index];\r\n                const time = element[0] / 45;\r\n                const speedX = (element[2] - widthBase) / time;\r\n                const speedY = (element[3] - heightBase) / time;\r\n                TimerAdmin._frameNumLoop(1, time, this, () => {\r\n                    widthBase += speedX;\r\n                    heightBase += speedY;\r\n                    element[2] = widthBase;\r\n                    element[3] = heightBase;\r\n                    Tools._Draw.reverseRoundrectMask(this._ImgVar('Background'), arr, true);\r\n                }, () => {\r\n                    func && func();\r\n                }, true);\r\n            }\r\n            handX && this._ImgVar('Hand').pos(handX, handY);\r\n        }\r\n        handAppear(delay, func) {\r\n            const time = 200;\r\n            Animation2D.scale(this._ImgVar('Hand'), 0, 0, 1, 1, time, delay ? delay : 0, () => {\r\n                func && func();\r\n            });\r\n            this._ImgVar('Handpic').rotation = -17;\r\n        }\r\n        bgAppear(delay, func) {\r\n            Tools._Node.destroyAllChildren(this._ImgVar('Background'));\r\n            const time = 300;\r\n            this._ImgVar('Handpic').rotation = -17;\r\n            Animation2D.fadeOut(this._ImgVar('Background'), 0, 1, time, delay ? delay : 0, () => {\r\n                func && func();\r\n            });\r\n        }\r\n        handVanish(delay, func) {\r\n            const time = 300;\r\n            this._ImgVar('Handpic').rotation = -17;\r\n            Animation2D.scale(this._ImgVar('Hand'), 1, 1, 0, 0, time, delay ? delay : 0, () => {\r\n                func && func();\r\n            });\r\n        }\r\n        bgVanish(delay, func) {\r\n            const time = 300;\r\n            Animation2D.fadeOut(this._ImgVar('Background'), 1, 0, time, delay ? delay : 0, () => {\r\n                func && func();\r\n            });\r\n        }\r\n        handMove(x, y, func, bgType) {\r\n            this.handClear();\r\n            const _y = y - 30;\r\n            const point = new Laya.Point(this._ImgVar('Hand').x, this._ImgVar('Hand').y);\r\n            const time = point.distance(x, _y);\r\n            Animation2D.move(this._ImgVar('Hand'), x, _y, time, () => {\r\n                func && func();\r\n            });\r\n            this._ImgVar('Hand').scale(1, 1);\r\n            Animation2D.move(this._ImgVar('Handpic'), 75, 56, time);\r\n            switch (bgType) {\r\n                case this.bgType.vanish:\r\n                    this.bgVanish();\r\n                    break;\r\n                case this.bgType.appear:\r\n                    this.bgAppear();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        handClear() {\r\n            this.lineStop();\r\n            TimerAdmin._clearAll([this._ImgVar('Hand')]);\r\n            Animation2D._clearAll([this._ImgVar('Hand')]);\r\n            this._AniVar('Frame').stop();\r\n            this._AniVar('Click').stop();\r\n            this._AniVar('ClickOne').stop();\r\n            this._ImgVar('Hand').visible = true;\r\n            this._ImgVar('Handpic').pos(75, 56);\r\n            this._ImgVar('Handpic').scale(1, 1);\r\n            this._ImgVar('Handpic').rotation = -17;\r\n        }\r\n        getGuideScissorTime(x, y) {\r\n            const point = Tools._Node.getNodeGP(this._Scissor);\r\n            return point.distance(x, y);\r\n        }\r\n        scissorTailor(first) {\r\n            if (!this._Scissor || this._closeLine)\r\n                return;\r\n            this._ImgVar('Hand').pos(this._Scissor.x, this._Scissor.y);\r\n            const index = Number(this.presentName.substr(4));\r\n            const pos = this.posArr[index - 1];\r\n            var func = () => {\r\n                this._AniVar('Click').play(0, false);\r\n                Animation2D.move(this._ImgVar('Hand'), pos[0], pos[1], this.getGuideScissorTime(pos[0], pos[1]), () => {\r\n                    this._AniVar(this.presentName).play(0, false);\r\n                }, 1500);\r\n            };\r\n            if (first) {\r\n                func();\r\n            }\r\n            else {\r\n                TimerAdmin._loop(6000, this._ImgVar('Hand'), () => {\r\n                    this.handAppear(0, () => {\r\n                        func();\r\n                    });\r\n                }, true);\r\n            }\r\n        }\r\n        startScissorTailor(Scissor) {\r\n            if (Scissor)\r\n                this._Scissor = Scissor;\r\n            this.presentName = 'Line01';\r\n            this._ImgVar('Hand').scale(1, 1);\r\n            Animation2D.move(this._ImgVar('Hand'), this._Scissor.x, this._Scissor.y, this.getGuideScissorTime(this._ImgVar('Hand').x, this._ImgVar('Hand').y), () => {\r\n                this.scissorTailor(true);\r\n                TimerAdmin._once(5000, this._ImgVar('Hand'), () => {\r\n                    this.scissorTailor();\r\n                });\r\n            });\r\n        }\r\n        lineStop() {\r\n            this._AniVar('Line01').stop();\r\n            this._AniVar('Line02').stop();\r\n            this._AniVar('Line03').stop();\r\n            this._AniVar('Line04').stop();\r\n        }\r\n        newScissorTailor(LineName) {\r\n            this.handClear();\r\n            if (this.nameArr.length > 1) {\r\n                for (let index = 0; index < this.nameArr.length; index++) {\r\n                    const element = this.nameArr[index];\r\n                    if (LineName === element) {\r\n                        this.nameArr.splice(index, 1);\r\n                        break;\r\n                    }\r\n                }\r\n                this.presentName = this.nameArr[0];\r\n                this.scissorTailor();\r\n            }\r\n            else {\r\n                this.presentName = null;\r\n                this._closeScene();\r\n            }\r\n        }\r\n        pattenAni(fx, fy, tx, ty) {\r\n            this.handAppear();\r\n            const time = 700;\r\n            const delay = 1000;\r\n            this._ImgVar('Hand').pos(fx, fy);\r\n            TimerAdmin._loop(time * 3 + delay, this._ImgVar('Hand'), () => {\r\n                this.handAppear(null, () => {\r\n                    TimerAdmin._once(200, this, () => {\r\n                        this._AniVar('ClickOne').play(0, false);\r\n                    });\r\n                    Animation2D.move(this._ImgVar('Hand'), tx, ty, time, () => {\r\n                        this.handVanish(300, () => {\r\n                            this._ImgVar('Hand').pos(fx, fy);\r\n                        });\r\n                    }, delay);\r\n                });\r\n            }, true);\r\n        }\r\n        lwgEvent() {\r\n            this._AniVar('Click').on(Laya.Event.LABEL, this, (e) => {\r\n                if (e === 'effect') {\r\n                    this.clickEffcet();\r\n                }\r\n            });\r\n            this._AniVar('ClickOne').on(Laya.Event.LABEL, this, (e) => {\r\n                if (e === 'effect') {\r\n                    this.clickEffcet();\r\n                }\r\n            });\r\n            this._AniVar('Frame').on(Laya.Event.LABEL, this, (e) => {\r\n                if (e === 'effect') {\r\n                    this.clickEffcet();\r\n                }\r\n            });\r\n            for (let index = 0; index < 4; index++) {\r\n                const element = this._AniVar(`Line0${index + 1}`);\r\n                element.on(Laya.Event.LABEL, this, (e) => {\r\n                    if (e === 'com') {\r\n                        this._ImgVar('Hand').pos(this._Scissor.x, this._Scissor.y);\r\n                        this._ImgVar('Hand').scale(0, 0);\r\n                        this._ImgVar('Handpic').scale(1, 1);\r\n                    }\r\n                });\r\n            }\r\n            const radius = 80;\r\n            this._evReg(_GameEvent.Guide.StartBtnDress, (x, y) => {\r\n                this.bgAppear(0, () => {\r\n                    this.boreholeCircle([[x, y, radius]], x, y, () => {\r\n                        this.handAppear(200, () => {\r\n                            this._AniVar('Click').play();\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorChangeCloth, () => {\r\n                const x = Laya.stage.width - 95;\r\n                const y = 370;\r\n                this.bgAppear(0, () => {\r\n                    this.boreholeCircle([[x, y, radius]], x, y, () => {\r\n                        this.handAppear(200, () => {\r\n                            this._AniVar('Click').play();\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorBtnCom, () => {\r\n                this._AniVar('Click').stop();\r\n                this.boreholeCircle([[this.btnComX, this.btnComY, radius], [Laya.stage.width / 2, Laya.stage.height / 2, 350]], null, null, () => {\r\n                    this.handMove(this.btnComX, this.btnComY, () => {\r\n                        this._AniVar('Click').play();\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorStartTailor, (Scissor) => {\r\n                this.bgVanish();\r\n                this.handClear();\r\n                this.startScissorTailor(Scissor);\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorNewTailor, (LineName) => {\r\n                this.newScissorTailor(LineName);\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorCloseTailor, () => {\r\n                if (!this.presentName)\r\n                    return;\r\n                this._closeLine = true;\r\n                this.handClear();\r\n                this._ImgVar('Hand').scale(0, 0);\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakeTailorOpenTailor, () => {\r\n                if (!this.presentName)\r\n                    return;\r\n                this._closeLine = false;\r\n                this.handClear();\r\n                this.scissorTailor();\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakePatternPattern1, () => {\r\n                const x = Laya.stage.width - 100;\r\n                const y = 280;\r\n                this.pattenAni(x, y, Laya.stage.width / 2, y);\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakePatternFrame, (Wireframe) => {\r\n                if (Wireframe)\r\n                    this._Wireframe = Wireframe;\r\n                const WConversion = this._Wireframe.getChildByName('WConversion');\r\n                const gP = this._Wireframe.localToGlobal(new Laya.Point(WConversion.x, WConversion.y));\r\n                this.handMove(gP.x, gP.y, () => {\r\n                    this._AniVar('Frame').play();\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakePatternTurnFace, () => {\r\n                this._AniVar('Frame').stop();\r\n                this.handClear();\r\n                const y = 180;\r\n                this.bgAppear(0, () => {\r\n                    this.boreholeCircle([[this.btnComX, y, radius]], null, null, () => { });\r\n                });\r\n                this.handMove(this.btnComX, y, () => {\r\n                    this._AniVar('Click').play();\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakePatternPattern2, () => {\r\n                this.handClear();\r\n                this._AniVar('Click').stop();\r\n                const x = Laya.stage.width - 100;\r\n                const y = 420;\r\n                this.bgVanish(0, () => {\r\n                    this.handMove(x, y, () => {\r\n                        this.pattenAni(x, y, Laya.stage.width / 2, y);\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.MakePatternBtnCom, () => {\r\n                this._AniVar('Frame').stop();\r\n                this._ImgVar('Handpic').scale(1, 1);\r\n                this.bgAppear(0, () => {\r\n                    this.boreholeCircle([[this.btnComX, this.btnComY, radius]], null, null, () => {\r\n                        this.handMove(this.btnComX, this.btnComY, () => {\r\n                            this._AniVar('Click').play();\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.TweetingBtnChoosePhoto, (x, y, handX, handY) => {\r\n                this.bgAppear(500, () => {\r\n                    this.boreholeRoundrect([[x, y, Laya.stage.width - 320 - 240, 300, 20]], handX, handY, () => {\r\n                        this.handAppear(null, () => {\r\n                            this._AniVar('Click').play();\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.TweetingChoosePhoto, (x, y) => {\r\n                this.boreholeRoundrect([[x, y, 280, 280, 20]], null, null, () => {\r\n                    this.handMove(x, y, () => {\r\n                        this._AniVar('Click').play();\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.TweetingBtnSend, (x, y) => {\r\n                this.boreholeRoundrect([[x, y, 220, 120, 20]], null, null, () => {\r\n                    this.handMove(x, y, () => {\r\n                        this._AniVar('Click').play();\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.TweetingBtnDoubleFans, (x, y) => {\r\n                this.bgAppear(0, () => {\r\n                    this.boreholeRoundrect([[x, y, 230, 120, 20]], x, y - 30, () => {\r\n                        this.handAppear(null, () => {\r\n                            this._AniVar('Click').play();\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n            this._evReg(_GameEvent.Guide.vanishGuide, () => {\r\n                this._AniVar('Click').stop();\r\n                this.handVanish();\r\n                this.bgVanish();\r\n            });\r\n            this._evReg(_GameEvent.Guide.closeGuide, () => {\r\n                this._closeScene();\r\n            });\r\n        }\r\n        lwgCloseAni() {\r\n            return 200;\r\n        }\r\n        lwgOnDisable() {\r\n            this._ImgVar('Background').destroy();\r\n        }\r\n    }\r\n    _Guide.Guide = Guide;\r\n})(_Guide || (_Guide = {}));\r\nexport default _Guide.Guide;\r\n",
  "references": [
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/Lwg.ts",
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/_GameAni.ts",
    "D:/Game/project/3DDressUp/Copy/3DDressUp_Laya2.9.0/3DDressUp_Laya2.9.0/src/script/Lwg/_GameEvent.ts"
  ]
}
