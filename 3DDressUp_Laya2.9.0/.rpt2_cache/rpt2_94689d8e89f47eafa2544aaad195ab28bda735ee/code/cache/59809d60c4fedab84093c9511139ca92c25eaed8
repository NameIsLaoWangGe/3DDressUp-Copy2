{
  "code": "import ADManager, { TaT } from \"../../TJ/Admanager\";\r\nimport { LwgScene, LwgData, LwgDialogue, LwgTimer, LwgTools, LwgPlatform } from \"../Lwg/Lwg\";\r\nimport { LwgOPPO } from \"../Lwg/LwgOPPO\";\r\nimport { _AllClothes, _DressingRoom, _Share, _Tweeting } from \"./_GameData\";\r\nimport { _GameEffects3D } from \"./_GameEffects3D\";\r\nimport { _Res } from \"./_Res\";\r\nimport { _UI } from \"./_UI\";\r\nimport { _3DScene } from \"./_3D\";\r\nimport { _SceneName } from \"./_SceneName\";\r\nimport RecordManager from \"../../TJ/RecordManager\";\r\nclass _Item extends LwgData._Item {\r\n    $button() {\r\n        this._btnUp(this._Owner, (e) => {\r\n            if (this.$data.name === 'ads') {\r\n                return;\r\n            }\r\n            if (_AllClothes._ins()._getProperty(this.$data.name, _AllClothes._ins()._property.complete)) {\r\n                _AllClothes._ins().accurateChange(this.$data['part'], this.$data.name);\r\n                _GameEffects3D._showCloth(_3DScene._ins()._Owner);\r\n            }\r\n            else {\r\n                ADManager.ShowReward(() => {\r\n                    if (_AllClothes._ins()._checkCondition(this.$data.name)) {\r\n                        LwgDialogue.createHint_Middle('恭喜获得新服装！');\r\n                        _AllClothes._ins().accurateChange(this.$data['part'], this.$data.name);\r\n                    }\r\n                });\r\n            }\r\n        }, null);\r\n    }\r\n    $render() {\r\n        if (this.$data.name === 'ads') {\r\n            !this._BoxChild('NativeRoot') && LwgTools._Node.createPrefab(_Res._list.prefab2D.NativeRoot.prefab, this._Owner);\r\n            this._ImgChild('Mask').visible = this._ImgChild('Icon').visible = this._ImgChild('Board').visible = false;\r\n        }\r\n        else {\r\n            this._BoxChild('NativeRoot') && this._BoxChild('NativeRoot').destroy();\r\n            this._ImgChild('Icon').visible = this._ImgChild('Board').visible = true;\r\n            if (this.$data.putOn) {\r\n                this._ImgChild('Board').skin = `Game/UI/Common/xuanzhong.png`;\r\n            }\r\n            else {\r\n                this._ImgChild('Board').skin = null;\r\n            }\r\n            if (this.$data.classify === _AllClothes._ins()._classify.DIY) {\r\n                if (TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.OPPO_AppRt) {\r\n                    this._ImgChild('Icon').skin = LwgOPPO._getStoragePic(this.$data.name);\r\n                    this._ImgChild('Icon').size(110, 130);\r\n                    this._ImgChild('Icon').scale(1, 1);\r\n                }\r\n                else {\r\n                    this._ImgChild('Icon').skin = this.$data.icon;\r\n                }\r\n            }\r\n            else {\r\n                this._ImgChild('Icon').size(null, null);\r\n                this._ImgChild('Icon').scale(0.9, 0.9);\r\n                this._ImgChild('Icon').skin = _AllClothes._ins().getGeneralIcon(this.$data.name);\r\n            }\r\n        }\r\n        if (this.$data.complete) {\r\n            this._ImgChild('Mask').visible = this._ImgChild('AdsSign').visible = false;\r\n        }\r\n        else {\r\n            this._ImgChild('Mask').visible = this._ImgChild('AdsSign').visible = true;\r\n        }\r\n    }\r\n}\r\nexport default class DressingRoom extends LwgScene._SceneBase {\r\n    lwgOnAwake() {\r\n        RecordManager.startAutoRecord();\r\n        ADManager.TAPoint(TaT.PageShow, 'changepage');\r\n        _3DScene._ins().openMirror(this._ImgVar('MirrorSurface'));\r\n        const copyDIYArr = _AllClothes._ins().collectDIY();\r\n        _AllClothes._ins()._List = this._ListVar('List');\r\n        _AllClothes._ins()._listRenderScript = _Item;\r\n        _AllClothes._ins()._listArray = _AllClothes._ins()._getArrByClassify(_AllClothes._ins()._classify.DIY);\r\n        if (copyDIYArr.length > 0) {\r\n            this.switchClassify(this._ImgVar('DIY'));\r\n        }\r\n        else {\r\n            this.switchClassify(this._ImgVar('Dress'));\r\n        }\r\n    }\r\n    lwgAdaptive() {\r\n        if (LwgPlatform._Ues.value === LwgPlatform._Tpye.Bytedance) {\r\n            this._ImgVar('BtnComplete').y += 80;\r\n        }\r\n        this._SpriteVar('Mirror').x = Laya.stage.width * 0.234;\r\n    }\r\n    lwgOnStart() {\r\n        _AllClothes._ins()._List.refresh();\r\n        this.UI = new _UI(this._Owner);\r\n        LwgTimer._frameOnce(10, this, () => {\r\n            this.UI.operationAppear(() => {\r\n                this.UI.btnCompleteAppear(null, 400);\r\n            });\r\n            this.UI.btnBackAppear(null, 200);\r\n        });\r\n        this.UI.btnCompleteClick = () => {\r\n            _3DScene._ins().closeMirror();\r\n            _3DScene._ins().cameraToSprite(this._Owner);\r\n            if (LwgPlatform._Ues.value === LwgPlatform._Tpye.Bytedance) {\r\n                LwgTimer._frameOnce(10, this, () => {\r\n                    RecordManager.stopAutoRecord();\r\n                    _Tweeting._photo.take(this._Owner, 3);\r\n                    _Share._whereFrom = _SceneName.DressingRoom;\r\n                    this._openScene(_SceneName.Share, false);\r\n                });\r\n            }\r\n            else if (LwgPlatform._Ues.value === LwgPlatform._Tpye.OPPO || LwgPlatform._Ues.value === LwgPlatform._Tpye.OPPOTest) {\r\n                this.backStart();\r\n            }\r\n        };\r\n    }\r\n    backStart() {\r\n        this.UI.operationVinish(() => {\r\n            Laya.Resource.destroyUnusedResources();\r\n            this._openScene(_SceneName.Start, true, true);\r\n            this.UI.btnBackVinish();\r\n        }, 200);\r\n    }\r\n    switchClassify(_element) {\r\n        let arr = [];\r\n        for (let index = 0; index < this._ImgVar('Part').numChildren; index++) {\r\n            const element = this._ImgVar('Part').getChildAt(index);\r\n            const Icon = element.getChildAt(0);\r\n            if (_element === element) {\r\n                element.skin = `Game/UI/Common/kuang_fen.png`;\r\n                Icon.skin = `Game/UI/DressingRoom/PartIcon/${element.name}_s.png`;\r\n                if (_element.name === 'DIY') {\r\n                    arr = _AllClothes._ins()._getArrByClassify(_element.name);\r\n                }\r\n                else {\r\n                    let _arr = _AllClothes._ins()._getArrByClassify(_AllClothes._ins()._classify.General);\r\n                    for (let index = 0; index < _arr.length; index++) {\r\n                        const obj = _arr[index];\r\n                        if (obj[_AllClothes._ins()._otherPro.part] === _element.name) {\r\n                            arr.push(obj);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                element.skin = `Game/UI/Common/kuang_bai.png`;\r\n                Icon.skin = `Game/UI/DressingRoom/PartIcon/${element.name}.png`;\r\n            }\r\n            _AllClothes._ins()._listArray = arr;\r\n        }\r\n    }\r\n    lwgButton() {\r\n        for (let index = 0; index < this._ImgVar('Part').numChildren; index++) {\r\n            const _element = this._ImgVar('Part').getChildAt(index);\r\n            this._btnUp(_element, () => {\r\n                this.switchClassify(_element);\r\n            }, 'no');\r\n        }\r\n    }\r\n    lwgEvent() {\r\n        this._evReg(_DressingRoom.Event.byteDanceBackStart, () => {\r\n            this.backStart();\r\n        });\r\n    }\r\n    lwgOnDisable() {\r\n        ADManager.TAPoint(TaT.PageLeave, 'changepage');\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/TJ/Admanager.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Lwg/Lwg.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Lwg/LwgOPPO.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_GameData.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_GameEffects3D.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_Res.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_UI.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_3D.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/script/Game/_SceneName.ts",
    "D:/Game/project/3DDressUp/Copy2/3DDressUp_Laya2.9.0/src/TJ/RecordManager.ts"
  ]
}
